<div class="container">
  <div class="page-head">
    <div>
      <div class="page-title">Dashboard</div>
      <div class="page-sub">Overview • Accounts</div>
    </div>
    <div class="head-actions">
      <button class="btn btn-primary" (click)="generatePaymentLink()">Create Payment Link</button>
      <button class="btn">Add Currency</button>
    </div>
  </div>

  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">Total Balance</div>
      <div class="stat-value">${{ totalBalanceUsd | number:'1.2-2' }}</div>
      <div class="stat-foot">Across all virtual accounts</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Pending</div>
      <div class="stat-value">${{ pendingUsd | number:'1.2-2' }}</div>
      <div class="stat-foot warn">Awaiting settlement</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Last Deposit</div>
      <div class="stat-value">${{ lastDepositUsd | number:'1.2-2' }}</div>
      <div class="stat-foot">2 days ago</div>
    </div>
  </div>

  <div class="main-grid">
    <div class="panel">
      <div class="panel-head">
        <div class="panel-title">Recent Activity</div>
        <button class="link" (click)="openActivityModal()">View all</button>
      </div>
      <div class="activity">
        <div class="activity-item" *ngFor="let t of transactions">
          <div class="activity-icon" [ngClass]="t.type">
            {{ t.type === 'deposit' ? '↓' : t.type === 'payment' ? '$' : t.type === 'refund' ? '↩' : '⚙' }}
          </div>
          <div class="activity-info">
            <div class="row-top">
              <div class="desc">{{ t.description }}</div>
              <div class="amount" [ngClass]="t.type">{{ t.currency }} {{ t.amount | number:'1.2-2' }}</div>
            </div>
            <div class="row-sub">
              <span>{{ t.timestamp }}</span>
              <span class="status" [ngClass]="t.status">{{ t.status }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="panel">
      <div class="panel-head">
        <div class="panel-title">USD Account Details</div>
        <img class="flag" src="https://flagcdn.com/us.svg" alt="US" />
      </div>
      <div class="account-grid">
        <div class="field">
          <div class="label">Account Name</div>
          <div class="value">{{ account.accountName }}</div>
          <button class="copy" (click)="copy(account.accountName, 'name')">{{ copiedField === 'name' ? 'Copied' : 'Copy' }}</button>
        </div>
        <div class="field">
          <div class="label">Account Number</div>
          <div class="value mono">{{ account.accountNumber }}</div>
          <button class="copy" (click)="copy(account.accountNumber, 'number')">{{ copiedField === 'number' ? 'Copied' : 'Copy' }}</button>
        </div>
        <div class="field">
          <div class="label">Routing Number</div>
          <div class="value mono">{{ account.routingNumber }}</div>
          <button class="copy" (click)="copy(account.routingNumber, 'routing')">{{ copiedField === 'routing' ? 'Copied' : 'Copy' }}</button>
        </div>
        <div class="field">
          <div class="label">IBAN</div>
          <div class="value mono">{{ account.iban }}</div>
          <button class="copy" (click)="copy(account.iban, 'iban')">{{ copiedField === 'iban' ? 'Copied' : 'Copy' }}</button>
        </div>
      </div>
      <div class="help">Share these details with payers to receive money directly to your USD virtual account.</div>
    </div>
  </div>
</div>

<!-- Activity Modal -->
<app-activity-modal 
  [activities]="activitiesForModal"
  [isOpen]="isActivityModalOpen"
  (close)="closeActivityModal()">
</app-activity-modal>
